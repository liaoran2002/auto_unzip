# Auto Unzip
一个自动化文件解压工具，支持多种压缩格式和分卷文件，带有图形界面和命令行接口。

## 功能特点

### 📦 支持的格式
- **主流压缩格式**: 7z、RAR、ZIP
- **分卷文件**: .part1.rar/.part2.rar、.r01/.r02、.7z.001/.7z.002
- **加密文件**: 支持密码列表自动尝试

### ⚡ 核心功能
- **自动化处理**: 自动识别压缩文件并递归解压
- **多线程**: 4个并发工作线程加速处理
- **智能重命名**: 自动处理同名文件
- **自动清理**: 解压后删除原压缩文件和分卷
- **实时日志**: 完整的操作记录和状态显示
- **GUI界面**: 直观的图形界面，支持拖放操作
- **命令行**: 支持批量处理多个文件

### 🎯 设计亮点
- **临时目录机制**: 安全的临时提取目录
- **密码管理**: 支持外部密码文件
- **错误处理**: 健壮的异常处理和重试机制
- **内存管理**: 低内存占用设计
- **跨平台兼容**: 支持Windows系统（需7z工具）

## 安装和要求

### 系统要求
源码安装要求：
- Windows 7/8/10/11
- Python 3.6+ (用于运行源代码)
- 7z压缩工具 (需与程序放在同一目录)
成品使用要求：
- Windows 7/8/10/11

### 文件结构
源码文件结构如下：
```
auto_unzip/
├── auto_unzip.py       # 主程序文件
├── passwords.txt       # 密码列表文件（可选）
├── README.md           # 项目说明文档
└── 7z.exe              # 7z压缩工具（需与程序放在同一目录）
```
成品文件结构如下：
```
auto_unzip.exe
passwords.txt
```

### 运行方式
#### 方法1：直接运行可执行文件
```bash
auto_unzip.exe
```

#### 方法2：使用Python运行
```bash
# 处理单个文件
python auto_unzip.py file.zip

# 处理多个文件
python auto_unzip.py file1.rar file2.7z

# 处理目录中的所有压缩文件
python auto_unzip.py "D:\Downloads\*".zip
```

#### 方法3：命令行参数
```bash
# 处理单个文件
auto_unzip.exe file.zip

# 处理多个文件
auto_unzip.exe file1.rar file2.7z

# 处理目录中的所有压缩文件
auto_unzip.exe "D:\Downloads\*".zip
```

## 使用指南

### 1. 基本使用
1. 运行程序，会弹出图形界面
2. 将压缩文件拖放到程序窗口（或使用命令行参数）
3. 程序会自动开始解压
4. 等待解压完成，窗口会自动关闭

### 2. 密码文件配置
创建`passwords.txt`文件并放在程序同一目录下：
```txt
# passwords.txt 示例
123456
password
123abc
# 注释行会被忽略
```
程序会自动尝试密码列表中的所有密码，无需手动输入。

### 3. 界面说明

#### 日志区域
- 显示详细的操作流程
- 显示密码尝试结果
- 显示文件处理状态

#### 状态栏
- 实时显示解压次数
- 显示当前任务数量

### 处理流程
1. 检查输入参数，确定要处理的文件或目录
2. 遍历所有文件，识别压缩文件格式
3. 为每个压缩文件创建临时提取目录
4. 尝试使用密码列表中的密码解压文件
5. 如果成功，记录密码并删除分卷文件
6. 递归处理解压后的目录，查找并解压嵌套压缩文件
7. 完成后，删除临时目录，清理资源

#### 线程管理
- 4个工作线程同时处理文件
- 线程安全的队列系统
- 自动关闭机制（所有任务完成后）

#### 临时文件
- 自动生成随机临时目录（tmp_xxxxxx）
- 确保文件安全提取
- 自动清理临时文件

#### 命名规则
- 同名文件自动重命名为 `tmp_xxxxxx_filename`
- 保持原始文件结构

### 配置参数
您可以在代码中修改以下配置：

```python
max_attempts = 10      # 单个文件最大尝试次数
max_workers = 4        # 最大线程数
temp_dir_prefix = 'tmp_'  # 临时目录前缀
compressed_exts = {'7z', 'rar', 'zip'}  # 支持的格式
```

### 自行打包
如果您需要修改参数配置，您可以使用PyInstaller打包。

#### 打包步骤
1. 确保已安装PyInstaller：
   ```bash
   pip install pyinstaller
   ```
2. 导航到项目目录：
   ```bash
   cd path/to/auto_unzip
   ```
3. 执行打包命令：
   ```bash
   pyinstaller --onefile --windowed --add-data "7z.exe;." auto_unzip.py
   ```
4. 在`dist`目录下找到生成的`auto_unzip.exe`文件。

## 常见问题

### Q: 程序没有反应？
A: 请确保：
- 7z工具在正确位置
- 文件路径不包含特殊字符
- 程序有足够的权限

### Q: 密码尝试失败？
A: 请检查：
- passwords.txt文件格式正确
- 密码包含在列表中
- 密码是否区分大小写

### Q: 解压速度慢？
A: 可以尝试：
- 减少并发线程数
- 关闭其他占用系统资源的程序
- 确保有足够的磁盘空间

## 注意事项

1. **文件安全**: 程序会删除原压缩文件，请确保备份重要文件
2. **密码安全**: 密码文件明文存储，请妥善保管
3. **分卷文件**: 所有分卷必须在同一目录
5. **权限问题**: 确保程序有读写文件的权限

## 技术支持

- 论坛: 吾爱破解论坛 www.52pojie.cn
- 作者: liaoran
- 版本: 1.0

## 更新日志

### v1.0 (初始版本)
- 支持主流压缩格式
- 分卷文件处理
- 密码列表支持
- 多线程解压
- 图形界面和命令行
- 自动清理功能

## 许可证


---
感谢使用Auto Unzip！